#!/Melify/bin/mac/tclkit

# tradeTimeInLong
# openPrice
# highPrice
# lowPrice
# lastPrice
# totalVolume

foreach i [glob *.dat] {
    puts $i

    set f [open $i r]
    set r [read $f]
    close $f

    set json "\["
    foreach j [split $r \n] {
	array set a $j

	append json "\["
	append json "$a(_updated),"	;# Updated
	append json "$a(70),"		;# Open
	append json "$a(70),"		;# High
	append json "$a(71),"		;# Low
	append json "$a(31)"		;# Last
	append json "\],"
    }

    set json [string replace $json end end]
    append json "\]"

    set fname "[file rootname $i].json"
    set f [open $fname w]
    puts $f $json
    close $f
}

