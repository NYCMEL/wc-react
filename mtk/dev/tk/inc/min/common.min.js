var tk={buffers:[],siteurl:location.protocol+"//"+location.host+location.pathname,siteport:location.port,browser:navigator.userAgent,init:function(){console.log("tk.init");tk.buffer()},flip:function(c,a,b){console.group("tk.flip: "+c+", "+a+", "+b);jQuery("#"+c+" > div").hide(0);if(b){$("#"+a).load(b).show(0)}else{$("#"+a).show(0)}console.groupEnd()},randomColor:function(){console.group("tk.randomColor");var a="#"+Math.floor(Math.random()*16777216).toString(16);return a;console.groupEnd()},RESTful:function(c,a,b){console.log("tk.RESTful");jQuery.ajax({async:false,cache:true,type:"GET",dataType:"jsonp",jsonpCallback:c,url:a,data:b,success:function(d){console.log("SUCCESS: "+tk.obj2str(d))},error:function(f,d,e){console.log(f.status+" | "+e+" | "+d)}})},submit:function(a,b){console.log("tk.submit: "+a+" "+b);jQuery("#"+a).submit(function(){jQuery.post(jQuery(this).attr("action"),jQuery(this).serialize(),function(c){jQuery("#"+b).html(c)})})},duplicates:function(){console.group("tk.duplicates");var a=false;jQuery("[id]").each(function(){var b=jQuery('[id="'+this.id+'"]');if(b.length>1&&b[0]==this){console.warn("Multiple ID #"+this.id);a=true}});if(!a){console.log("No duplicate id(s)")}console.groupEnd()},load:function(b,a,c){console.log("tk.load: "+b+" "+a+" fade = "+c);tk.tracker("tk.load",b+","+a);jQuery.get(a+"&ajax=1",function(d){obj=jQuery(b);if(typeof c=="undefined"){c=0}obj.html(d).hide().fadeIn(c,function(){try{jQuery.publish("tk.load",[b])}catch(f){console.log(f.name+" > "+f.message)}});return obj});return false},_div_exist:function(a){return jQuery("#"+a).length},loadScriptSync:function(b){var a=document.createElement("script");a.src=b;a.type="text/javascript";a.async=false;document.getElementsByTagName("head")[0].appendChild(a)},loadAsync:function(a,b){jQuery.ajax({url:a,dataType:"script",cache:true,success:b||jQuery.noop})},dumpCookies:function(b){console.group("dumpCookies");var e=document.cookie.split(";");for(var c=0;c<e.length;c++){var d=e[c].indexOf("=");if(a!=b){var a=d>-1?e[c].substr(0,d):e[c];document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT";console.log("removed: "+a)}}console.groupEnd()},buffer:function(){console.log("tk.buffer");jQuery(document).ready(function(){jQuery(".tk-link").each(function(a){$(this).removeClass("tk-link");jQuery(this).click(function(g){g.preventDefault();var f=jQuery(this);var j=f.attr("tk-target");var c=f.attr("tk-url");var h=f.attr("tk-src");var b=f.attr("tk-cache");tk.tracker("tk.buffer",j+","+c);console.log("#"+j+" > div");jQuery("#"+j+" > div").addClass("tk-div");jQuery("#"+j+" > .tk-div").fadeOut(0).hide();if(b==0){jQuery("#"+h).remove()}f.removeClass("tk-link");console.log("TGT: "+j+", SRC: "+h+", cache:"+b+", URL: "+c);if(tk._div_exist(h)==0){var d=$("#"+j).parents(".tk-div").attr("id");if(!d){d=""}tk.buffers.push({src:h,tgt:d});jQuery("#"+j).append("<div class=tk-div style=display:block id='"+h+"'><div style=padding:10px><img tgt=/tk/img/common/loading.2.gif></div></div>");tk.load("#"+h,c,0);try{jQuery.publish("tk.buffer",["new",h])}catch(g){console.log(g.name+" > "+g.message)}}else{if(b=="1"){jQuery("#"+h).fadeIn(0);try{jQuery.publish("tk.buffer",["old",h])}catch(g){console.log(g.name+" > "+g.message)}}}return false})})})},bufferShow:function(b){console.group("tk.bufferShow: "+b);for(var a=0;a<tk.buffers.length;a++){var c=tk.buffers[a];if(b==c.tgt){console.log("\t>>>>>>>>>>: "+b+" | "+JSON.stringify(c))}else{}}console.groupEnd()},obj2str:function(e,a,b,d){a=a!=null?a:" ";b=b!=null?b:"\n";d=d!=null?d:" ";var f="";for(var g in e){if(typeof e[g]=="string"||typeof e[g]=="number"){var c=typeof e[g]=="string"?"":"";f+=d+g+": "+c+e[g]+c+"; "+a}else{f+=d+g+": {"+a+print(e[g],a,b,d+d)+d+"}"+b}}return f},str2obj:function(str){eval("var obj="+str);return obj},include:function(b){console.log("tk.include: "+b);filetype=b.split(".").pop();tk.tracker("tk.include",b);if(filetype=="js"){fileref=document.createElement("script");fileref.setAttribute("type","text/javascript");fileref.setAttribute("src",b)}else{if(filetype=="css"){fileref=document.createElement("link");fileref.setAttribute("rel","stylesheet");fileref.setAttribute("type","text/css");fileref.setAttribute("href",b)}else{if(filetype=="html"){console.log("not quite working ! async issue...");var a=jQuery.get(b,function(){console.log(a.responseText)})}}}document.getElementsByTagName("head")[0].appendChild(fileref)},blink:function(a,b){console.log("tk.blink: "+a+", "+b);for(i=0;i<b;i++){jQuery(a).fadeTo("slow",0.2).fadeTo("slow",1)}},_setDOM:function(c,b){console.group("tk._setDOM");dnm=c.attr("dom-data");tag=c.prop("tagName");rad=c.is(":radio");chk=c.is(":checkbox");console.log(c.prop("tagName")+" "+dnm+" = "+b);if(tag==="INPUT"){if(rad||chk){if(rad){var a=c.attr("name");a=a.replace("(","\\(");a=a.replace(")","\\)");jQuery("[name="+a+"]").each(function(){if(jQuery(this).val()==b){jQuery(this).attr("checked",true)}else{jQuery(this).attr("checked",false)}})}else{if(c.val()==b){c.attr("checked",true)}}}else{c.val(b)}}else{if(tag==="SELECT"){c.val(b)}else{c.html(b)}}console.groupEnd();return true},updateDOM:function(){console.group("tk.updateDOM");jQuery("[dom-data]").each(function(){obj=jQuery(this);dnm=obj.attr("dom-data");var a=$.cookie(dnm);if(a!=null){console.log(dnm+" = "+a);tk._setDOM(obj,a);console.groupEnd()}});jQuery("[tk-data]").each(function(){obj=jQuery(this);val=obj.attr("tk-data");if(val!=null){console.log(val);tk._setDOM(obj,val);console.groupEnd()}});console.groupEnd();return true},block:function(b,a,d,c){console.group("tk.block: "+b+", "+a+", "+d+", "+c);tk.tracker("tk.block",b+","+a);if($(".tk-blocker").length==0){console.log("creating tk-blocker div");$("body").append("<div style='display:none;text-align:left' class='tk-blocker'></div>")}else{console.log("tk-blocker div already exist")}$(".tk-blocker").load(a+"&ajax=1");$.blockUI({message:jQuery(".tk-blocker"),css:{width:b,cursor:null},overlayCSS:{cursor:"not-allowed"},timeout:d});$(".blockUI.blockMsg").hide();setTimeout(function(){$(".blockUI.blockMsg").css("z-index","999999");$(".blockUI.blockMsg").center().show()},300);console.groupEnd()},block2:function(a,b){console.group("tk.block2: "+a);if(b==null){b="700px"}tk.tracker("tk.block"+a);if($(".tk-modal").length==0){$("body").append("<div class='modal tk-modal' tabindex='-1' role='dialog' style='display:none' data-backdrop='static'><div class='modal-dialog><div class='modal-dialog'><div class='modal-content' style=width:"+b+"><div class='modal-body'></div></div></div></div></div>")}jQuery(".tk-modal .modal-body").load(a,function(){jQuery(".tk-modal").show();w=jQuery(".tk-modal .modal-dialog").width();jQuery(".tk-modal").css("margin-top",Math.max(0,(($(window).height()-$(this).outerHeight())/2)+$(window).scrollTop())+"px").css("margin-left",Math.max(0,(($(window).width()-$(this).outerWidth())/2)+$(window).scrollLeft())+"px")});console.groupEnd()},cloudify:function(){console.group("tk.component");jQuery("mtk-component").each(function(){var c=jQuery(this);var a=c.parent();var b=c.html();jQuery(a).load(tk.siteurl+"?ajax=1&isolate=1&callback=tk::melifyit&code="+encodeURI(b));console.groupEnd()})},tracker:function(b,a){console.group("tk.tracker: "+b);if(a==undefined){a="init"}console.groupEnd()},center:function(d,c){console.group("tk.center: handle="+d+", parent= "+c);ele=$(d);if(c==null){c=window}var a=ele.height();var b=ele.width();if(c==window){t=($(c).height()/2)-(a/2);l=($(c).width()/2)-(b/2)}else{t=($(c).height()/2)-(a/2)-$(c).position().top;l=($(c).width()/2)-(b/2)+$(c).position().left}console.warn("top:"+t+", left:"+l);ele.css("top",t);ele.css("left",l);console.groupEnd();return ele},_ctracker_:function(){console.group("_ctracker_");var b=Math.round(+new Date()/1000);var a="";jQuery(".tk-component").each(function(){var d=$(this);var e=d.attr("id");var c=d.attr("class");a+=(e+","+c+","+location+","+b+",")});console.error(jQuery(".tk-component").length+" : "+a);jQuery(".tk-dummy").load(tk.siteurl+"?ajax=1&callback=_ctracker_&values="+escape(a));console.groupEnd("test.init")},blur:function(b,a){var c="blur("+a+"px)";$(b).css("filter",c).css("webkitFilter",c).css("mozFilter",c).css("oFilter",c).css("msFilter",c)},link2buffer:function(a){console.group("app.link2buffer: "+tk.obj2str(a));jQuery("#"+a.container+" a").each(function(){var c=$(this);var d=$(this).attr("id");var b=$(this).attr("href");if(b!=""&&d!=undefined){console.log(d+", "+b);c.addClass("tk-link").attr("tk-url",b).attr("tk-src",d+"-link-container").attr("tk-target",a.target).attr("tk-cache",a.cache).attr("href","#")}});console.groupEnd()},buffer2:function(c,d,b,a){console.group("app.buffer: "+c+", "+d+", "+b+", "+a);$("#"+d+" > div").hide(0);if($("#"+c).length==0){console.log("src does not exist. create it");$("#"+d).append($("<div class=tk-buffered id="+c+">").load(b))}else{console.log("src exist. show it");$("#"+d+" #"+c).show(0)}console.groupEnd()},getURL:function(a){console.group("app.getURL");if(typeof a.type==="undefined"){a.type="GET"}if(typeof a.async==="undefined"){a.async=false}if(typeof a.cache==="undefined"){a.cache=false}console.log("OPTIONS:",JSON.stringify(a));var b=$.ajax({type:a.type,url:a.url,data:a.data,cache:a.cache,async:a.async}).responseText;console.groupEnd();return b}};jQuery(document).ready(function(){tk.init();if(0){window.onerror=function(c,b,a){alert(c+", "+b+", "+a)}}});jQuery.fn.center=function(){t=Math.max(0,(($(window).height()-$(this).outerHeight())/2)+$(window).scrollTop());l=Math.max(0,(($(window).width()-$(this).outerWidth())/2)+$(window).scrollLeft());if(t<100){t=100}this.css("position","absolute");this.css("top",t);this.css("left",l);return this};namespace=function(g,m){if(typeof g!="string"){throw ('TYPE_ERROR:"string required"')}var h,e=g.split("."),n=this,j=[],d,k;m=m||0;for(h in e){n?e[h] in n?(n=n[e[h]],j.push(e[h]),d=!0):d=!1:0}k=[d,n,j,e,g];return m<0?k:k[+m||m]};function bootstrapEnv(){var c=["xs","sm","md","lg"];var b=$("<div>");b.appendTo($("body"));for(var a=c.length-1;a>=0;a--){var d=c[a];b.addClass("hidden-"+d);if(b.is(":hidden")){b.remove();return d}}};