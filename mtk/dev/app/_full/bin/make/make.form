#!/Melify/bin/mac/tclkit

if {$argc != 1} {
    puts "\nusage: make.form <file.name>\n"
    exit
}

# l = label
# t = text 
# c = checkbox
# r = radio
# u = custom
# s = select
# x = empty

if {0} {
    source [lindex $argv 0]
} else {
    #set form {xlt rlt cps xxbp}
    set form {lt lt cl}
}

set clock [clock second]

set f1 [open /tmp/[lindex $argv 0].tcl w]
puts $f1 "# set form \{$form\}\n"

set row 0
foreach i [split $form] {
    set tmp1 ""
    set tmp2 ""
    set col  0
    set e   "e"
    
    incr row

    for {set j 0} {$j < [string length $i]} {incr j} {
	incr col

	set erow "\[id\]-c$col"
	set ecol "\[id\]-r$row"
	set eid  "\[id\]-[incr clock]"

	switch [string index $i $j] {
	    "p" {
		append tmp1 [subst {
		    division class="pull-left $erow" {
			put \[span id="$eid" "PUT"\]
		    }
		}]
	    }
	    "s" {
		append tmp1 [subst {
		    division class="pull-left $erow" {
			select $eid id="$eid" {
			    option {Please Select}
			}
		    }
		}]
	    }
	    "l" {
		append tmp1 [subst {
		    division class="pull-left $erow" {
			label id="$eid" "LABEL"
		    }
		}]
	    }
	    
	    "b" {
		append tmp1 [subst {
		    division class="pull-left $erow" {
			put \[url "BUTTON" "#" id="$eid" class="btn btn-default"\]
		    }
		}]
	    }

	    "r" {
		append tmp1 [subst {
		    division class="pull-left $erow" {
			radio_button v($eid)=1 id="$eid" 
		    }
		}]
	    }

	    "c" {
		append tmp1 [subst {
		    division class="pull-left $erow" {
			checkbox v($eid)= id="$eid" 
		    }
		}]
	    }

	    "t" {
		append tmp1 [subst {
		    division class="pull-left $erow" {
			text v($eid)= id="$eid" type="text" class="form-control"
		    }
		}]
	    }

	    "x" {
		append tmp1 [subst {
		    division class="pull-left $erow" {
			put \[span id="$eid" "&nbsp;"\]
		    }
		}]
	    }
	}
    }

    puts -nonewline $f1 "division class=\"clearfix\" id=\"$ecol\" \{"
    puts $f1 $tmp1
    puts -nonewline $f1 "\}\n"
}

close $f1 

